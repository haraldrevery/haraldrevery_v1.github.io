let targetRotateX=0,targetRotateY=0,currentRotateX=0,currentRotateY=0;const logoSvg=document.getElementById("main-logo-svg");function smoothRotate(){if(logoSvg){currentRotateX+=.29*(targetRotateX-currentRotateX),currentRotateY+=.29*(targetRotateY-currentRotateY),logoSvg.style.transform=`translateX(-9.81%) rotateX(${currentRotateX}deg) rotateY(${currentRotateY}deg) translateZ(50px)`;const shadowColor=document.documentElement.classList.contains("dark")?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.3)";logoSvg.style.filter=`drop-shadow(${.5*currentRotateY}px ${.5*currentRotateX}px 20px ${shadowColor})`}requestAnimationFrame(smoothRotate)}let plexusRequestId;document.addEventListener("mousemove",e=>{targetRotateY=40*(e.clientX/window.innerWidth-.5),targetRotateX=-40*(e.clientY/window.innerHeight-.5)}),document.addEventListener("mouseout",e=>{e.relatedTarget||e.toElement||(targetRotateY=0,targetRotateX=0)}),smoothRotate();let mouseX=0,mouseY=0,targetX=0,targetY=0;document.addEventListener("mousemove",e=>{mouseX=(e.clientX-window.innerWidth/2)/(window.innerWidth/2),mouseY=(e.clientY-window.innerHeight/2)/(window.innerHeight/2)}),window.restartPlexus=function(){plexusRequestId&&cancelAnimationFrame(plexusRequestId);const canvas=document.getElementById("plexus-canvas"),svg=document.getElementById("main-logo-svg");if(!canvas||!svg)return;const ctx=canvas.getContext("2d"),rgb=document.documentElement.classList.contains("dark")?"255, 255, 255":"26, 26, 26",isMobile=window.innerWidth<768,targetParticleCount=isMobile?0:421,connectionDistance=isMobile?0:150,connDistSq=connectionDistance*connectionDistance,posX=new Float32Array(targetParticleCount),posY=new Float32Array(targetParticleCount),velX=new Float32Array(targetParticleCount),velY=new Float32Array(targetParticleCount);let currentParticleCount=0;const startTime=Date.now();function createParticle(i){posX[i]=1e3*Math.random(),posY[i]=1100*Math.random(),velX[i]=.8*(Math.random()-.5),velY[i]=.8*(Math.random()-.5)}!function animate(){ctx.clearRect(0,0,1e3,1100);const progress=Math.min((Date.now()-startTime)/3e3,1),targetThisFrame=Math.floor(progress*targetParticleCount);for(;currentParticleCount<targetThisFrame;)createParticle(currentParticleCount),currentParticleCount++;ctx.fillStyle=`rgba(${rgb}, 0.8)`;for(let i=0;i<currentParticleCount;i++)posX[i]+=velX[i],posY[i]+=velY[i],(posX[i]<0||posX[i]>1e3)&&(velX[i]*=-1),(posY[i]<0||posY[i]>1100)&&(velY[i]*=-1),ctx.fillRect(posX[i]-1,posY[i]-1,2,2);ctx.lineWidth=.8;for(let i=0;i<currentParticleCount;i++){const x1=posX[i],y1=posY[i];for(let j=i+1;j<currentParticleCount;j++){const dx=x1-posX[j],dy=y1-posY[j],distSq=dx*dx+dy*dy;if(distSq<connDistSq){const alpha=.8*(1-Math.sqrt(distSq)/connectionDistance);ctx.beginPath(),ctx.strokeStyle=`rgba(${rgb}, ${alpha.toFixed(2)})`,ctx.moveTo(x1,y1),ctx.lineTo(posX[j],posY[j]),ctx.stroke()}}}plexusRequestId=requestAnimationFrame(animate)}()},document.addEventListener("DOMContentLoaded",()=>{window.restartPlexus()}),window.restartLogoAnimations=function(){const logoGroup=document.querySelector("#logo-shape-definition.animate-logo"),waves=document.querySelectorAll(".wave-echo");if(!logoGroup)return;logoGroup.querySelectorAll("path").forEach(path=>{path.style.animation="none",path.style.strokeDashoffset="4000",path.style.fillOpacity="0",path.offsetWidth,path.style.animation="logoDraw 5s cubic-bezier(.75,.03,.46,.46) forwards"}),waves.forEach((wave,index)=>{wave.style.animation="none",wave.style.transform="scale(5)",wave.style.opacity="0",wave.style.strokeWidth="0.5px",wave.offsetWidth,setTimeout(()=>{wave.style.animation="implodingWave 3.5s cubic-bezier(0.19, 1, 0.22, 1) forwards"},100*index)})},setTimeout(()=>window.restartPlexus(),150),setTimeout(()=>window.restartLogoAnimations(),1),document.addEventListener("alpine:init",()=>{Alpine.data("plexusBackground",()=>({canvas:null,ctx:null,particles:[],startTime:null,config:{particleCount:0,lineDistance:0,particleSize:1.59,baseSpeed:.4,lineOpacity:.2},mouse:{x:-9999,y:-9999},init(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.startTime=Date.now();const isMobile=window.innerWidth<768;this.config.particleCount=isMobile?28:96,this.config.lineDistance=isMobile?299:221,this.handleResize(),window.addEventListener("resize",()=>this.handleResize()),window.addEventListener("mousemove",e=>{this.mouse.x=e.clientX,this.mouse.y=e.clientY}),this.animate()},handleResize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight;const isMobile=window.innerWidth<768;this.config.particleCount=isMobile?40:96,this.config.lineDistance=isMobile?200:221},createParticle(){return{x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,vx:(Math.random()-.5)*this.config.baseSpeed,vy:(Math.random()-.5)*this.config.baseSpeed}},animate(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const progress=Math.min((Date.now()-this.startTime)/3e3,1),currentTarget=Math.floor(progress*this.config.particleCount);for(;this.particles.length<currentTarget;)this.particles.push(this.createParticle());const color=this.darkMode?"255, 255, 255":"0, 0, 0";this.ctx.fillStyle=`rgba(${color}, 0.4)`,this.ctx.strokeStyle=`rgba(${color}, ${this.config.lineOpacity})`,this.particles.forEach((p,i)=>{const dxMouse=p.x-this.mouse.x,dyMouse=p.y-this.mouse.y,speedMult=Math.sqrt(dxMouse*dxMouse+dyMouse*dyMouse)<250?1.96:1;p.x+=p.vx*speedMult,p.y+=p.vy*speedMult,(p.x<0||p.x>this.canvas.width)&&(p.vx*=-1),(p.y<0||p.y>this.canvas.height)&&(p.vy*=-1),this.ctx.beginPath(),this.ctx.arc(p.x,p.y,this.config.particleSize,0,2*Math.PI),this.ctx.fill();for(let j=i+1;j<this.particles.length;j++){const p2=this.particles[j],dist=Math.hypot(p.x-p2.x,p.y-p2.y);dist<this.config.lineDistance&&(this.ctx.lineWidth=1.5*(1-dist/this.config.lineDistance),this.ctx.beginPath(),this.ctx.moveTo(p.x,p.y),this.ctx.lineTo(p2.x,p2.y),this.ctx.stroke())}}),requestAnimationFrame(()=>this.animate())}}))});
